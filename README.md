<div align="center">
  <img height="100" src="https://github.com/Rankarusu/RankaBotMk3/assets/48137583/9c943792-1ff8-4e58-aa80-0364dfe13611">
  <h1>RankaBot MK III</h1>
  
  ![GitHub package.json version](https://img.shields.io/github/package-json/v/Rankarusu/RankaBotMk3)
  ![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/Rankarusu/RankaBotMk3/build.yml)
  [![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=Rankarusu_RankaBotMk3&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=Rankarusu_RankaBotMk3)
  [![Coverage](https://sonarcloud.io/api/project_badges/measure?project=Rankarusu_RankaBotMk3&metric=coverage)](https://sonarcloud.io/summary/new_code?id=Rankarusu_RankaBotMk3)
</div>

## About

  A personal discord bot with some useful and some not so useful commands.
  
  As all good things are three, this is the third iteration of the discord bot I built. 
  The first one was one of my first projects when I started to learn programming. It was a terrible mess of spaghetti without version control written in python.
  The second one was still written in python, way less of a mess, but still bad. I used this project to learn TS and I really fell in love with the language during development. I'm quite proud of this one.

  I used [discord.js](https://github.com/discordjs/discord.js) and took some architectual inspiration from [KevinNovaks template](https://github.com/KevinNovak/Discord-Bot-TypeScript-Template)
<div>
  <img src="https://img.shields.io/badge/Node%20js-339933?style=for-the-badge&logo=nodedotjs&logoColor=white">
  <img src="https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white">
  <img src="https://img.shields.io/badge/Prisma-3982CE?style=for-the-badge&logo=Prisma&logoColor=white">
  <img src="https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white">
  <img src="https://img.shields.io/badge/Docker-2CA5E0?style=for-the-badge&logo=docker&logoColor=white">
</div>


## Commands

please use `/help` for the most updated list of commands and further instructions on how the use them. Seriously, I put a lot od effort into the help commad. Please use it.

<table>
  <thead>
    <tr>
      <th>Category</th>
      <th>Command</th>
      <th>Subcommand</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">Anime</td>
      <td rowspan="2">/anime</td>
      <td>search</td>
      <td>search for a series</td>
    </tr>
    <tr>
      <td>schedule</td>
      <td>get the schedule of all airing anime this week</td>
    </tr>
    <tr>
      <td>/uwuify</td>
      <td></td>
      <td>make text kyute and cwinge uwu</span></td>
    </tr>
    <tr>
      <td rowspan="6">Moderation</td>
      <td>/ban</td>
      <td></td>
      <td>bans a user</td>
    </tr>
    <tr>
      <td>/unban</td>
      <td></td>
      <td>unbans a user</td>
    </tr>
    <tr>
      <td>/kick</td>
      <td></td>
      <td>kicks a user</td>
    </tr>
    <tr>
      <td>/purge</td>
      <td></td>
      <td>deletes the last x messages in a channel</td>
    </tr>
    <tr>
      <td>/timeout</td>
      <td></td>
      <td>mutes a user</td>
    </tr>
    <tr>
      <td>/unitmeout</td>
      <td></td>
      <td>unmutes a user</td>
    </tr>
    <tr>
      <td rowspan="2">DnD</td>
      <td>/bless</td>
      <td></td>
      <td>reminds you that you have bless up</td>
    </tr>
    <tr>
      <td>/roll</td>
      <td></td>
      <td>roll polyhedral dice</td>
    </tr>
    <tr>
      <td rowspan="13">Misc</td>
      <td>/bofh</td>
      <td></td>
      <td>generate a bastard-operator-from-hell-like excuse</td>
    </tr>
    <tr>
      <td>/choose</td>
      <td></td>
      <td>like eightball but less vague</td>
    </tr>
    <tr>
      <td>/coinflip</td>
      <td></td>
      <td>take a wild guess</td>
    </tr>
    <tr>
      <td>/dadjoke</td>
      <td></td>
      <td>post a dad joke</td>
    </tr>
    <tr>
      <td>/eightball</td>
      <td></td>
      <td>as a digital ball for advice</td>
    </tr>
    <tr>
      <td>/hug</td>
      <td></td>
      <td>display your affection towards another user</td>
    </tr>
    <tr>
      <td>/poll</td>
      <td></td>
      <td>start a poll with up to 10 options</td>
    </tr>
    <tr>
      <td>/reddit</td>
      <td></td>
      <td>browse reddit</td>
    </tr>
    <tr>
      <td rowspan="3">/sticker</td>
      <td>add</td>
      <td>add a sticker to your server</td>
    </tr>
    <tr>
      <td>post</td>
      <td>post a sticker</td>
    </tr>
    <tr>
      <td>list</td>
      <td>get a list of all stickers on your server</td>
    </tr>
    <tr>
      <td rowspan="2">/tarot</td>
      <td>draw</td>
      <td>draw a tarot card</td>
    </tr>
    <tr>
      <td>search</td>
      <td>get infos about the meaning of a card</td>
    </tr>
    <tr>
      <td rowspan="3">NSFW</td>
      <td>/danbooru</td>
      <td></td>
      <td>browse danbooru</td>
    </tr>
    <tr>
      <td>/r34</td>
      <td></td>
      <td>( ͡° ͜ʖ ͡°)</td>
    </tr>
    <tr>
      <td>/lewds</td>
      <td></td>
      <td>a stream of carefully selected pieces of art for cultured people</td>
    </tr>
    <tr>
      <td rowspan="7">PokéMon</td>
      <td rowspan="7">/dex</td>
      <td>pokemon</td>
      <td>search for PokéMon</td>
    </tr>
    <tr>
      <td>ability</td>
      <td>search for an abilty</td>
    </tr>
    <tr>
      <td>berry</td>
      <td>search for a berry</td>
    </tr>
    <tr>
      <td>item</td>
      <td>search for items</td>
    </tr>
    <tr>
      <td>move</td>
      <td>search for moves</td>
    </tr>
    <tr>
      <td>nature</td>
      <td>search for natures</td>
    </tr>
    <tr>
      <td>pdr</td>
      <td>find out what moves are effective against the selected type(s)</td>
    </tr>
    <tr>
      <td rowspan="2">Exp</td>
      <td rowspan="2">/exp</td>
      <td>user</td>
      <td>display a users exp on this server</td>
    </tr>
    <tr>
      <td>leaderboard</td>
      <td>display a leaderboard for this server</td>
    </tr>
    <tr>
      <td rowspan="5">Utility</td>
      <td>/help</td>
      <td></td>
      <td>get an overview about all commands or further details on a specific one</td>
    </tr>
    <tr>
      <td>/info</td>
      <td></td>
      <td>display information about the bot</td>
    </tr>
    <tr>
      <td>/ping</td>
      <td></td>
      <td>pong!</td>
    </tr>
    <tr>
      <td rowspan="2">/remind</td>
      <td>set</td>
      <td>set a reminder and get pinged at the specific time</td>
    </tr>
    <tr>
      <td>list</td>
      <td>display a list of all reminders and delete unneeded ones</td>
    </tr>
  </tbody>
</table>

## Installation
### Manually
  1. fill out `config/config_template.json` with your credentials and db config
  2. create a `.env` file with `DATABASE_URL` set to the connection string to your db. Prisma needs this.
  3. make sure your db also runs where you configured it would
  4. run the bot via `npm run prod:db`. This will automatically migrate your db.

### Via Docker Compose
This project also gets built into a docker image on docker hub. An example config including db could look like this:

```yaml
version: '3'

services:
  rankabot:
    container_name: "rankabotmk3"
    image: rankarusu/rankabotmk3
    restart: 'always'
    depends_on:
      database:
        condition: service_healthy
    env_file:
      - .env
    volumes:
      - /path/to/your/config:/app/config

  database:
    container_name: "postgres"
    image: postgres
    restart: 'always'
    ports:
      - '5432:5432'
    env_file:
      - .env
    healthcheck:
      test: ['CMD-SHELL', 'pg_isready -U postgres']
      interval: 5s
      timeout: 5s
      retries: 5
    volumes:
      - /path/to/volume/data:/var/lib/postgresql/data
```

